(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[937],{7412:(e,t,s)=>{"use strict";s.d(t,{A:()=>v});var a=s(4848),c=s(9028),i=s.n(c),n=s(4335);async function r(){return(await n.A.get("https://api.themoviedb.org/3/authentication/token/new",{method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"}})).data}var o=s(6540),l=s(1468),d=s(7235);async function h(e){let t=n.A.request({method:"POST",url:"https://api.themoviedb.org/3/authentication/session/new",headers:{accept:"application/json","content-type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"},data:{request_token:e}});return(await t).data}async function m(e){let t={method:"GET",url:"https://api.themoviedb.org/3/account/21839650?api_key=".concat("367a786553f6d6acd23b37641e73be0b","&session_id=").concat(e),headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"}};return(await n.A.request(t)).data}s(4156);var p=s(2957);function j(){let e=(0,l.wA)();return(0,a.jsx)("input",{type:"text",className:"form-control me-2",placeholder:"Search for a movie...",value:(0,l.d4)(e=>e.searchMovie.searchMovieName),onChange:t=>{e((0,p.Oj)(t.target.value))}})}var u=s(1106),N=s.n(u);function x(e){let{children:t}=e,{session:s}=(0,l.d4)(e=>e.TMDBUser),c=(0,o.useMemo)(()=>s.success?(0,a.jsx)("li",{className:"nav-item",children:(0,a.jsx)(N(),{className:"nav-link",href:"/watch-list",children:"待播清單"})}):(0,a.jsx)(a.Fragment,{}),[s]);return(0,a.jsx)("div",{className:"w-100 sticky-top bg-dark p-1",children:(0,a.jsxs)("div",{className:"row align-items-center",children:[(0,a.jsx)("div",{className:"col-auto",children:(0,a.jsx)(N(),{href:"/",className:"nav-link",children:(0,a.jsx)("h2",{children:"TMDB"})})}),(0,a.jsx)("div",{className:"col",children:(0,a.jsx)("div",{className:"d-flex justify-content-end",children:(0,a.jsxs)("nav",{className:"navbar navbar-expand-lg ",children:[(0,a.jsx)(j,{}),(0,a.jsx)("div",{className:"collapse navbar-collapse",children:(0,a.jsxs)("ul",{className:"navbar-nav",children:[c,(0,a.jsx)("li",{className:"nav-item",children:t})]})})]})})})]})})}function v(){let e=(0,l.wA)(),{requestToken:t,session:s,profile:c}=(0,l.d4)(e=>e.TMDBUser),[n,p]=(0,o.useState)("https://www.themoviedb.org/authenticate/".concat(t.request_token,"?redirect_to=https://localhost:3000"));(0,o.useEffect)(()=>{s.success&&m(s.session_id).then(t=>{e((0,d.gL)(t))})},[s,e]),(0,o.useEffect)(()=>{if(location&&!s.success){let{protocol:e,pathname:s,host:a}=location;p("https://www.themoviedb.org/authenticate/".concat(t.request_token,"?redirect_to=").concat(e,"//").concat(a).concat(s))}},[t,s]),(0,o.useEffect)(()=>{let t={success:!1,session_id:""};if(localStorage.getItem("tmdbSession")&&(t=JSON.parse(localStorage.getItem("tmdbSession"))),t.success)e((0,d.Nq)(t));else{let s=new URLSearchParams(location.search).get("approved"),a=new URLSearchParams(location.search).get("request_token");"true"==s&&a?t.success||h(a).then(t=>e((0,d.Nq)(t))).catch(()=>{r().then(t=>e((0,d.dC)(t)))}):r().then(t=>e((0,d.dC)(t)))}},[e]);let j=(0,o.useMemo)(()=>c.id&&s.success?(0,a.jsx)("div",{className:i().avatar,children:(0,a.jsx)("h3",{children:c.username[0]})}):(0,a.jsx)("a",{className:"btn btn-primary",href:n,children:"Login"}),[c,s,n]);return(0,a.jsx)(x,{children:j})}},8341:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var a=s(4848),c=s(7909),i=s(9965),n=s.n(i),r=s(6540),o=s(1468),l=s(2957),d=s(4335);async function h(e){return(await d.A.request({method:"GET",url:"https://api.themoviedb.org/3/movie/".concat(e,"/credits?language=en-US"),headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"}})).data}let m=function(e){let{movie:t,isWatchList:s}=e,{profile:i,session:d}=(0,o.d4)(e=>e.TMDBUser),{activeMovie:m}=(0,o.d4)(e=>e.searchMovie),p=(0,o.wA)(),j=e=>{p((0,l.dJ)(e)),p((0,l.Fb)(!0)),h(e.id).then(e=>p((0,l.xE)(e)))},u=(0,r.useMemo)(()=>i.id&&d.success&&m.id?s?(0,a.jsx)("button",{className:"btn btn--primary",children:"已加入清單"}):(0,a.jsx)("button",{className:"btn btn--primary",onClick:()=>{(0,c.A)(i.id,d.session_id,m.id)},children:"Add to watch List"}):(0,a.jsx)(a.Fragment,{}),[i,d,m,s]),N=t.poster_path?"https://image.tmdb.org/t/p/w500".concat(t.poster_path):"https://www.themoviedb.org/assets/2/v4/glyphicons/basic/glyphicons-basic-38-picture-grey-c2ebdbb057f2a7614185931650f8cee23fa137b93812ccb132b9df511df1cfac.svg";return(0,a.jsx)("div",{className:"col-lg-4 col-sm-6 mb-3",children:(0,a.jsxs)("div",{className:"card border border-secondary",onClick:()=>{j(t)},children:[(0,a.jsx)(n(),{src:N,width:0,height:0,sizes:"100vw",style:{width:"100%",height:"300px",objectFit:"cover"},className:"card-img-top",alt:"Waves"}),(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("h5",{className:"card-title text-truncate",children:t.title}),(0,a.jsx)("span",{className:"text-secondary",children:t.release_date||"查無日期"}),(0,a.jsx)("div",{className:"w-100",children:u})]})]})},t.id)}},758:(e,t,s)=>{"use strict";s.d(t,{A:()=>p});var a=s(4848),c=s(7909),i=s(5780),n=s.n(i),r=s(2957),o=s(9965),l=s.n(o),d=s(6715),h=s(6540),m=s(1468);function p(){let e=(0,m.wA)(),{pathname:t}=(0,d.useRouter)(),{profile:s,session:i}=(0,m.d4)(e=>e.TMDBUser),{showMovieDetail:o,movieCredits:p,activeMovie:j}=(0,m.d4)(e=>e.searchMovie),[u,N]=(0,h.useState)("https://www.themoviedb.org/assets/2/v4/glyphicons/basic/glyphicons-basic-38-picture-grey-c2ebdbb057f2a7614185931650f8cee23fa137b93812ccb132b9df511df1cfac.svg"),x=(0,h.useMemo)(()=>s.id&&i.success&&j.id?"/watch-list"==t?(0,a.jsx)("button",{className:"btn btn--primary",children:"已加入清單"}):(0,a.jsx)("button",{className:"btn btn--primary",onClick:e=>{(0,c.A)(s.id,i.session_id,j.id).then(t=>{t.success&&(e.target.innerHTML='<a href="/watch-list">前往查看待播放清單</a>')})},children:"Add to watch List"}):(0,a.jsx)(a.Fragment,{}),[s,i,j,t]),v=(0,h.useMemo)(()=>p.cast.length>0?(0,a.jsx)("div",{style:{display:"flex",width:"300px",overflowX:"auto"},children:p.cast.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"border",style:{width:"150px"},children:[(0,a.jsx)(l(),{src:"https://media.themoviedb.org/t/p/w276_and_h350_face".concat(e.profile_path),width:0,height:0,sizes:"100vw",style:{width:"150px",height:"150px",objectFit:"cover"},className:"card-img-top",alt:"Waves"}),(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("h5",{className:"card-title text-truncate",children:e.original_name}),(0,a.jsx)("span",{className:"text-secondary",children:e.character})]})]},e.cast_id))}):null,[p]);return((0,h.useEffect)(()=>{N("https://image.tmdb.org/t/p/w500".concat(j.poster_path))},[j]),j&&o&&p)?(0,a.jsx)("div",{className:n().popupOverlay,children:(0,a.jsxs)("div",{className:n().popup,children:[(0,a.jsx)("div",{className:"w-100 d-flex justify-content-end mb-1 cursor-pointer",style:{position:"fixed",height:"100vh",right:"1rem",top:"1rem"},onClick:()=>e((0,r.Fb)(!1)),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"row m-0",children:[(0,a.jsx)("div",{className:"col-lg-4 p-3 d-flex justify-content-center align-items-center bg-light",children:(0,a.jsx)(l(),{src:u,width:0,height:0,style:{width:"auto",height:"auto",maxWidth:"100%",maxHeight:"500px"},className:"card-img-top",alt:"Waves"})}),(0,a.jsx)("div",{className:"col d-flex justify-content-center align-items-start",children:(0,a.jsxs)("div",{className:"w-100 p-3 text-start",children:[(0,a.jsx)("h3",{children:j.title}),(0,a.jsx)("p",{children:j.overview}),(0,a.jsx)("span",{className:"text-secondary",children:j.release_date||"查無日期"}),v,(0,a.jsx)("div",{className:"w-100 mt-1",children:x})]})})]})})]})}):(0,a.jsx)(a.Fragment,{})}},5133:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(4848);function c(e){let{children:t}=e;return(0,a.jsx)("div",{children:t})}s(6540)},7909:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(4335);async function c(e,t,s){let c={method:"POST",url:"https://api.themoviedb.org/3/account/".concat(e,"/watchlist?session_id=").concat(t),headers:{accept:"application/json","content-type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"},data:{media_type:"movie",media_id:s,watchlist:!0}};return(await a.A.request(c)).data}},9028:e=>{e.exports={avatar:"LoginButton_avatar__M7Ag9"}},5780:e=>{e.exports={popupOverlay:"MovieCard_popupOverlay__YMaBY",popup:"MovieCard_popup__mfObJ"}},4156:e=>{e.exports={"form-control":"SearchMovieBar_form-control__W2Slc"}}}]);