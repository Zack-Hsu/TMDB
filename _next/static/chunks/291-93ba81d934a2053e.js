(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[291],{1561:(e,t,s)=>{"use strict";s.d(t,{A:()=>x,V:()=>v});var a=s(4848),i=s(9028),c=s.n(i),n=s(4335);async function l(){return(await n.A.get("https://api.themoviedb.org/3/authentication/token/new",{method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"}})).data}var r=s(6540),o=s(1468),d=s(7235);async function h(e){let t=n.A.request({method:"POST",url:"https://api.themoviedb.org/3/authentication/session/new",headers:{accept:"application/json","content-type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"},data:{request_token:e}});return(await t).data}async function m(e){let t={method:"GET",url:"https://api.themoviedb.org/3/account/21839650?api_key=".concat("367a786553f6d6acd23b37641e73be0b","&session_id=").concat(e),headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"}};return(await n.A.request(t)).data}var p=s(1106),u=s.n(p),j=s(2845);function v(){let e=(0,o.wA)(),{requestToken:t,session:s,profile:i}=(0,o.d4)(e=>e.TMDBUser),[c,n]=(0,r.useState)(!1),[p,v]=(0,r.useState)(""),[x,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s.success&&m(s.session_id).then(t=>{e((0,d.gL)(t))})},[s,e]),(0,r.useEffect)(()=>{if(!s.success){let{protocol:e,host:s,pathname:a}=window.location;v("https://www.themoviedb.org/authenticate/".concat(t.request_token,"?redirect_to=").concat(e,"//").concat(s).concat(a))}},[t,s]),(0,r.useEffect)(()=>{let t=JSON.parse(localStorage.getItem("tmdbSession")||"{}");if(null==t?void 0:t.success)e((0,d.Nq)(t));else{let t=new URLSearchParams(window.location.search),s=t.get("approved"),a=t.get("request_token");"true"===s&&a?h(a).then(t=>e((0,d.Nq)(t))).catch(()=>l().then(t=>e((0,d.dC)(t)))):l().then(t=>e((0,d.dC)(t)))}},[e]),(0,r.useEffect)(()=>{s.success&&i.id?N(!0):N(!1)},[s,i]);let b=(0,r.useMemo)(()=>s.success?(0,a.jsxs)(u(),{className:"dropdown-item align-items-center d-flex",href:"/watch-list",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-view-list me-3",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{d:"M3 4.5h10a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2m0 1a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1zM1 2a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 2m0 12a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 14"})})," 待播清單"]}):null,[s]);return{profile:i,session:s,TMDBAuthUrl:p,isDropdownOpen:c,setDropdownOpen:n,handleLogout:()=>{e((0,d.Nq)(d.Bk)),e((0,d.gL)(d.K)),e((0,j.Cp)(j.uJ)),l().then(t=>e((0,d.dC)(t)))},WatchListLink:b,isLogin:x}}function x(){let{profile:e,TMDBAuthUrl:t,isDropdownOpen:s,setDropdownOpen:i,handleLogout:n,WatchListLink:l,isLogin:r}=v();return r?(0,a.jsxs)("div",{className:"dropdown",children:[(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)("div",{className:c().avatar,onClick:()=>i(!s),children:e.username[0]}),(0,a.jsx)("div",{className:"dropdown-toggle",style:{marginLeft:".25rem"}})]}),(0,a.jsxs)("div",{className:"dropdown-menu ".concat(s?"show":""),style:{right:0},children:[l,(0,a.jsxs)("button",{className:"dropdown-item",onClick:n,children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-box-arrow-right me-3",viewBox:"0 0 16 16",children:[(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),(0,a.jsx)("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"})]}),"登出 TMDB"]})]})]}):(0,a.jsx)(u(),{className:"btn btn-light",href:t,children:"登入"})}},2909:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var a=s(4848),i=s(7909),c=s(9965),n=s.n(c),l=s(6540),r=s(1468),o=s(2845),d=s(4335);async function h(e){return(await d.A.request({method:"GET",url:"https://api.themoviedb.org/3/movie/".concat(e,"/credits?language=en-US"),headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"}})).data}function m(e){let{movie:t,isWatchList:s}=e,{profile:c,session:d}=(0,r.d4)(e=>e.TMDBUser),{activeMovie:m}=(0,r.d4)(e=>e.searchMovie),p=(0,r.wA)(),u=e=>{p((0,o.dJ)(e)),p((0,o.Fb)(!0)),h(e.id).then(e=>p((0,o.xE)(e)))},j=(0,l.useMemo)(()=>c.id&&d.success&&m.id?s?(0,a.jsx)("button",{className:"btn btn--primary",children:"已加入清單"}):(0,a.jsx)("button",{className:"btn btn--primary",onClick:()=>{(0,i.A)(c.id,d.session_id,m.id)},children:"Add to watch List"}):(0,a.jsx)(a.Fragment,{}),[c,d,m,s]),v=t.poster_path?"https://image.tmdb.org/t/p/w500".concat(t.poster_path,"/"):"https://www.themoviedb.org/assets/2/v4/glyphicons/basic/glyphicons-basic-38-picture-grey-c2ebdbb057f2a7614185931650f8cee23fa137b93812ccb132b9df511df1cfac.svg";return(0,a.jsx)("div",{className:"col-lg-4 col-sm-6 mb-3",children:(0,a.jsxs)("div",{className:"card border border-secondary",onClick:()=>{u(t)},children:[(0,a.jsx)(n(),{src:v,width:0,height:0,sizes:"100vw",style:{width:"100%",height:"300px",objectFit:"cover"},className:"card-img-top",alt:"Waves"}),(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("h5",{className:"card-title text-truncate",children:t.title}),(0,a.jsx)("span",{className:"text-secondary",children:t.release_date||"查無日期"}),(0,a.jsx)("div",{className:"w-100",children:j})]})]})},t.id)}},854:(e,t,s)=>{"use strict";s.d(t,{A:()=>x});var a=s(4848),i=s(1468),c=s(2909),n=s(6715),l=s(1106),r=s.n(l),o=s(7909),d=s(2894),h=s.n(d),m=s(2845),p=s(9965),u=s.n(p),j=s(6540);function v(){let e=(0,i.wA)(),{pathname:t}=(0,n.useRouter)(),{profile:s,session:c}=(0,i.d4)(e=>e.TMDBUser),{showMovieDetail:l,movieCredits:r,activeMovie:d}=(0,i.d4)(e=>e.searchMovie),[p,v]=(0,j.useState)("https://www.themoviedb.org/assets/2/v4/glyphicons/basic/glyphicons-basic-38-picture-grey-c2ebdbb057f2a7614185931650f8cee23fa137b93812ccb132b9df511df1cfac.svg"),x=(0,j.useMemo)(()=>s.id&&c.success&&d.id?"/watch-list"==t?(0,a.jsx)("button",{className:"btn btn--primary",children:"已加入清單"}):(0,a.jsx)("button",{className:"btn btn--primary",onClick:e=>{(0,o.A)(s.id,c.session_id,d.id).then(t=>{t.success&&(e.target.innerHTML='<a href="/TMDB/watch-list">前往查看待播放清單</a>')})},children:"Add to watch List"}):(0,a.jsx)(a.Fragment,{}),[s,c,d,t]),N=(0,j.useMemo)(()=>r.cast.length>0?(0,a.jsx)("div",{style:{display:"flex",width:"300px",overflowX:"auto"},children:r.cast.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"border",style:{width:"150px"},children:[(0,a.jsx)(u(),{src:"https://media.themoviedb.org/t/p/w276_and_h350_face".concat(e.profile_path),width:0,loading:"lazy",height:0,sizes:"100vw",style:{width:"150px",height:"150px",objectFit:"cover"},className:"card-img-top",alt:"Waves"}),(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("h5",{className:"card-title text-truncate",children:e.original_name}),(0,a.jsx)("span",{className:"text-secondary",children:e.character})]})]},e.cast_id))}):null,[r]);return((0,j.useEffect)(()=>{v("https://image.tmdb.org/t/p/w500".concat(d.poster_path))},[d]),d&&l&&r)?(0,a.jsx)("div",{className:h().popupOverlay,children:(0,a.jsxs)("div",{className:h().popup,children:[(0,a.jsx)("div",{className:"w-100 d-flex justify-content-end mb-1 cursor-pointer",style:{position:"fixed",height:"100vh",right:"1rem",top:"1rem"},onClick:()=>e((0,m.Fb)(!1)),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"row m-0",children:[(0,a.jsx)("div",{className:"col-lg-4 p-3 d-flex justify-content-center align-items-center bg-light",children:(0,a.jsx)(u(),{src:p,width:0,height:0,sizes:"100vw",style:{width:"auto",height:"auto",maxWidth:"100%",maxHeight:"500px"},className:"card-img-top",alt:"Waves"})}),(0,a.jsx)("div",{className:"col d-flex justify-content-center align-items-start",children:(0,a.jsxs)("div",{className:"w-100 p-3 text-start",children:[(0,a.jsx)("h3",{children:d.title}),(0,a.jsx)("p",{children:d.overview}),(0,a.jsx)("span",{className:"text-secondary",children:d.release_date||"查無日期"}),N,(0,a.jsx)("div",{className:"w-100 mt-1",children:x})]})})]})})]})}):(0,a.jsx)(a.Fragment,{})}function x(){var e;let{searchResult:t}=(0,i.d4)(e=>e.searchMovie),{pathname:s}=(0,n.useRouter)();return 0==t.results.length?"/watch-list"==s?(0,a.jsxs)("h4",{children:["目前沒有待播放的電影喔，請前往探索 ",(0,a.jsx)(r(),{href:"/",className:"btn btn-sm btn-light",children:"探索去"})]}):(0,a.jsx)("h4",{className:"w-100 text-center",children:"查無結果，請重新搜尋"}):(0,a.jsxs)("div",{className:"row",children:[null==t?void 0:null===(e=t.results)||void 0===e?void 0:e.map(e=>(0,a.jsx)(c.A,{movie:e},e.id)),(0,a.jsx)(v,{})]})}},9428:(e,t,s)=>{"use strict";s.d(t,{A:()=>p});var a=s(4848);s(6540);var i=s(2845),c=s(1468);function n(){let e=(0,c.wA)();return(0,a.jsxs)("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{e((0,i.OA)("asc")),window.scrollTo(0,0)},children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-sort-alpha-down",viewBox:"0 0 16 16",children:[(0,a.jsx)("path",{fillRule:"evenodd",d:"M10.082 5.629 9.664 7H8.598l1.789-5.332h1.234L13.402 7h-1.12l-.419-1.371zm1.57-.785L11 2.687h-.047l-.652 2.157z"}),(0,a.jsx)("path",{d:"M12.96 14H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645zM4.5 2.5a.5.5 0 0 0-1 0v9.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L4.5 12.293z"})]}),(0,a.jsx)("span",{className:"visually-hidden",children:"Button"})]})}function l(){let e=(0,c.wA)();return(0,a.jsxs)("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{e((0,i.OA)("desc")),window.scrollTo(0,0)},children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-sort-alpha-down-alt",viewBox:"0 0 16 16",children:[(0,a.jsx)("path",{d:"M12.96 7H9.028v-.691l2.579-3.72v-.054H9.098v-.867h3.785v.691l-2.567 3.72v.054h2.645z"}),(0,a.jsx)("path",{fillRule:"evenodd",d:"M10.082 12.629 9.664 14H8.598l1.789-5.332h1.234L13.402 14h-1.12l-.419-1.371zm1.57-.785L11 9.688h-.047l-.652 2.156z"}),(0,a.jsx)("path",{d:"M4.5 2.5a.5.5 0 0 0-1 0v9.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L4.5 12.293z"})]}),(0,a.jsx)("span",{className:"visually-hidden",children:"Button"})]})}function r(){return(0,a.jsx)("div",{className:"position-fixed",style:{bottom:"2rem",right:"1rem"},children:(0,a.jsxs)("div",{className:"btn-group",children:[(0,a.jsx)(n,{}),(0,a.jsx)(l,{})]})})}var o=s(1561),d=s(1106),h=s.n(d);function m(){return(0,a.jsx)("nav",{className:"navbar navbar-expand-lg bg-body-tertiary",children:(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)(h(),{className:"navbar-brand",href:"/",children:(0,a.jsx)("h3",{children:"TMDB"})}),(0,a.jsx)("div",{className:"navbar-toggler border-0 d-block",children:(0,a.jsx)(o.A,{})})]})})}function p(e){let{children:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)(m,{}),t,(0,a.jsx)(r,{})]})}},7909:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(4335);async function i(e,t,s){let i={method:"POST",url:"https://api.themoviedb.org/3/account/".concat(e,"/watchlist?session_id=").concat(t),headers:{accept:"application/json","content-type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIzNjdhNzg2NTUzZjZkNmFjZDIzYjM3NjQxZTczYmUwYiIsIm5iZiI6MTc0MDM2NzE1MC4yNTUsInN1YiI6IjY3YmJlNTJkYmQ0OGU4OTI0Y2JlZTVhYSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Xa3Po7q0eXaQe4jofc07HDfFxkv_k_pDe9FS_RbNNhM"},data:{media_type:"movie",media_id:s,watchlist:!0}};return(await a.A.request(i)).data}},9028:e=>{e.exports={avatar:"LoginButton_avatar__M7Ag9"}},2894:e=>{e.exports={popupOverlay:"MovieCardPopUp_popupOverlay__2T4It",popup:"MovieCardPopUp_popup__0TlMZ"}}}]);